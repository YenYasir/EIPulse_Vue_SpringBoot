(function() {
  var Client, EventEmitter, assert, noop, ref, reject, resolve;

  assert = require("assert");

  EventEmitter = require("events");

  Client = require("./client");

  noop = require("lodash").noop;

  ref = require("bluebird"), resolve = ref.resolve, reject = ref.reject;

  describe("Client", function() {
    beforeEach(function() {
      this.transport = new EventEmitter();
      return this.client = new Client(this.transport);
    });
    describe("send frame", function() {
      it("should send to transport", function() {
        this.transport.sendFrame = function(frame) {
          assert(frame);
          return resolve();
        };
        return this.client.sendFrame({});
      });
      return it("should not send when disconnected", function() {
        this.client.disconnected = true;
        return this.client.sendFrame()["catch"](function(err) {
          return /disconnected/.test(err.message);
        });
      });
    });
    describe("auto heartbeat", function() {
      it("should not send if zero", function() {
        this.transport.autoHeartbeat = function() {
          throw new Error("invalid code path");
        };
        return this.client.autoHeartbeat("5000,0");
      });
      return it("should send heartbeat max", function() {
        this.transport.autoHeartbeat = function(ms) {
          return assert.equal(ms, 60000);
        };
        return this.client.autoHeartbeat("5000,60000");
      });
    });
    describe("send frame with receipt", function() {
      it("should generate unique id", function() {
        var receipts;
        receipts = [];
        this.transport.sendFrame = (function(_this) {
          return function(frame) {
            receipts.push(frame.headers["receipt"]);
            return resolve();
          };
        })(this);
        this.client.sendFrameWithReceipt({
          headers: {}
        });
        this.client.sendFrameWithReceipt({
          headers: {}
        });
        return assert.notEqual(receipts[0], receipts[1]);
      });
      it("should resolve when received", function() {
        this.transport.sendFrame = (function(_this) {
          return function(frame) {
            setImmediate(function() {
              var receipt;
              receipt = {
                command: "RECEIPT",
                headers: {
                  "receipt-id": frame.headers["receipt"]
                }
              };
              return _this.transport.emit("frame", receipt);
            });
            return resolve();
          };
        })(this);
        return this.client.sendFrameWithReceipt({
          headers: {}
        });
      });
      return it("should fail on server error", function() {
        var onSuccess;
        this.transport.sendFrame = (function(_this) {
          return function(frame) {
            setImmediate(function() {
              var error;
              error = {
                command: "ERROR",
                headers: {
                  "receipt-id": frame.headers["receipt"]
                }
              };
              return _this.transport.emit("frame", error);
            });
            return resolve();
          };
        })(this);
        onSuccess = function() {
          throw new Error("invalid code path");
        };
        return this.client.sendFrameWithReceipt({
          headers: {}
        }).then(onSuccess, noop);
      });
    });
    describe("connect", function() {
      it("should require headers", function() {
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.connect();
          };
        })(this)), /headers/);
      });
      it("should require accept version", function() {
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.connect({});
          };
        })(this)), /accept-version/);
      });
      it("should require host", function() {
        var headers;
        headers = {
          "accept-version": "1.2"
        };
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.connect(headers);
          };
        })(this)), /host/);
      });
      it("should send connect command", function() {
        this.transport.sendFrame = function(frame) {
          assert.equal(frame.command, "CONNECT");
          return resolve();
        };
        this.client.connect({
          "accept-version": "1.2",
          host: "localhost"
        });
        return null;
      });
      it("should add default heart-beat", function() {
        this.transport.sendFrame = function(frame) {
          assert.equal(frame.headers["heart-beat"], "10000,0");
          return resolve();
        };
        this.client.connect({
          "accept-version": "1.2",
          host: "localhost"
        });
        return null;
      });
      return it("should resolve when connected", function() {
        this.transport.sendFrame = (function(_this) {
          return function() {
            setImmediate(function() {
              var connected;
              connected = {
                command: "CONNECTED",
                headers: {}
              };
              return _this.transport.emit("frame", connected);
            });
            return resolve();
          };
        })(this);
        return this.client.connect({
          "accept-version": "1.2",
          host: "localhost"
        });
      });
    });
    describe("send", function() {
      it("should require headers", function() {
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.send();
          };
        })(this)), /headers/);
      });
      it("should require destination", function() {
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.send({});
          };
        })(this)), /destination/);
      });
      return it("should map to send command", function() {
        this.transport.sendFrame = function(frame) {
          assert.equal(frame.command, "SEND");
          return resolve();
        };
        this.client.send({
          destination: "/ottawa"
        });
        return null;
      });
    });
    describe("subscribe", function() {
      it("should require headers", function() {
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.subscribe();
          };
        })(this)), /headers/);
      });
      it("should require destination", function() {
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.subscribe({});
          };
        })(this)), /destination/);
      });
      it("should map to subscribe command", function() {
        this.transport.sendFrame = function(frame) {
          assert.equal(frame.command, "SUBSCRIBE");
          return resolve();
        };
        this.client.subscribe({
          id: "1",
          destination: "/toronto"
        });
        return null;
      });
      return it("should generate unique ids", function() {
        var ids;
        ids = [];
        this.transport.sendFrame = function(frame) {
          ids.push(frame.headers.id);
          return resolve();
        };
        this.client.subscribe({
          destination: "/peru"
        });
        this.client.subscribe({
          destination: "/iceland"
        });
        return assert.notEqual(ids[0], ids[1]);
      });
    });
    describe("unsubscribe", function() {
      it("should require headers", function() {
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.unsubscribe();
          };
        })(this)), /headers/);
      });
      it("should require id", function() {
        return assert.throws(((function(_this) {
          return function() {
            return _this.client.unsubscribe({});
          };
        })(this)), /id/);
      });
      return it("should map to unsubscribe command", function() {
        this.transport.sendFrame = function(frame) {
          assert.equal(frame.command, "UNSUBSCRIBE");
          return resolve();
        };
        this.client.unsubscribe({
          id: "sub-1"
        });
        return null;
      });
    });
    describe("source", function() {
      it("should subscribe and unsubscribe", function(done) {
        var commands, complete, source, sub;
        commands = [];
        this.transport.sendFrame = (function(_this) {
          return function(frame) {
            var receipt;
            commands.push(frame.command);
            receipt = {
              command: "RECEIPT",
              headers: {
                "receipt-id": frame.headers["receipt"]
              }
            };
            _this.transport.emit("frame", receipt);
            return resolve();
          };
        })(this);
        source = this.client.source({
          destination: "/paris"
        });
        complete = function() {
          assert.equal(commands[0], "SUBSCRIBE");
          assert.equal(commands[1], "UNSUBSCRIBE");
          return done();
        };
        sub = source.subscribe({
          next: noop,
          error: noop,
          complete: complete
        });
        setTimeout((function() {
          return sub.unsubscribe();
        }), 5);
        return setTimeout(complete, 5);
      });
      return it("should push frame body message", function(done) {
        var onMessage, source, sub;
        this.transport.sendFrame = (function(_this) {
          return function(frame) {
            var receipt;
            receipt = {
              command: "RECEIPT",
              headers: {
                "receipt-id": frame.headers["receipt"]
              }
            };
            _this.transport.emit("frame", receipt);
            return resolve();
          };
        })(this);
        source = this.client.source({
          destination: "/moscow",
          id: "S1"
        });
        sub = source.subscribe({
          next: function(message) {
            assert.equal(message, "ok");
            sub.unsubscribe();
            return done();
          }
        });
        onMessage = (function(_this) {
          return function() {
            var message;
            message = {
              command: "MESSAGE",
              headers: {
                subscription: "S1"
              },
              body: "ok"
            };
            return _this.transport.emit("frame", message);
          };
        })(this);
        return setTimeout(onMessage, 5);
      });
    });
    return describe("disconnect", function() {
      it("should close transport on receipt", function(done) {
        this.transport.sendFrame = (function(_this) {
          return function(frame) {
            var receipt;
            receipt = {
              command: "RECEIPT",
              headers: {
                "receipt-id": frame.headers["receipt"]
              }
            };
            _this.transport.emit("frame", receipt);
            return resolve();
          };
        })(this);
        this.transport.close = done;
        return this.client.disconnect();
      });
      return it("should close transport on error", function(done) {
        this.transport.sendFrame = (function(_this) {
          return function(frame) {
            var error;
            error = {
              command: "ERROR",
              headers: {
                "receipt-id": frame.headers["receipt"]
              }
            };
            _this.transport.emit("frame", error);
            return resolve();
          };
        })(this);
        this.transport.close = done;
        this.client.disconnect()["catch"](noop);
        return null;
      });
    });
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsaWVudC9jbGllbnQtdGVzdC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxNQUFBOztFQUFBLE1BQUEsR0FBUyxPQUFBLENBQVEsUUFBUjs7RUFDVCxZQUFBLEdBQWUsT0FBQSxDQUFRLFFBQVI7O0VBQ2YsTUFBQSxHQUFTLE9BQUEsQ0FBUSxVQUFSOztFQUNSLE9BQVEsT0FBQSxDQUFRLFFBQVIsRUFBUjs7RUFDRCxNQUFvQixPQUFBLENBQVEsVUFBUixDQUFwQixFQUFDLGNBQUEsT0FBRCxFQUFVLGFBQUE7O0VBRVYsUUFBQSxDQUFTLFFBQVQsRUFBbUIsU0FBQTtJQUNqQixVQUFBLENBQVcsU0FBQTtNQUNULElBQUMsQ0FBQSxTQUFELEdBQWlCLElBQUEsWUFBQSxDQUFBO2FBQ2pCLElBQUMsQ0FBQSxNQUFELEdBQWMsSUFBQSxNQUFBLENBQU8sSUFBQyxDQUFBLFNBQVI7SUFGTCxDQUFYO0lBSUEsUUFBQSxDQUFTLFlBQVQsRUFBdUIsU0FBQTtNQUNyQixFQUFBLENBQUcsMEJBQUgsRUFBK0IsU0FBQTtRQUM3QixJQUFDLENBQUEsU0FBUyxDQUFDLFNBQVgsR0FBdUIsU0FBQyxLQUFEO1VBQ3JCLE1BQUEsQ0FBTyxLQUFQO2lCQUNBLE9BQUEsQ0FBQTtRQUZxQjtlQUd2QixJQUFDLENBQUEsTUFBTSxDQUFDLFNBQVIsQ0FBa0IsRUFBbEI7TUFKNkIsQ0FBL0I7YUFNQSxFQUFBLENBQUcsbUNBQUgsRUFBd0MsU0FBQTtRQUN0QyxJQUFDLENBQUEsTUFBTSxDQUFDLFlBQVIsR0FBdUI7ZUFDdkIsSUFBQyxDQUFBLE1BQU0sQ0FBQyxTQUFSLENBQUEsQ0FDRSxDQUFDLE9BQUQsQ0FERixDQUNTLFNBQUMsR0FBRDtpQkFDTCxjQUFjLENBQUMsSUFBZixDQUFvQixHQUFHLENBQUMsT0FBeEI7UUFESyxDQURUO01BRnNDLENBQXhDO0lBUHFCLENBQXZCO0lBYUEsUUFBQSxDQUFTLGdCQUFULEVBQTJCLFNBQUE7TUFDekIsRUFB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QUFDckIsZ0JBQUE7WUFBQSxLQUFBLEdBQ0U7Y0FBQSxPQUFBLEVBQVMsT0FBVDtjQUNBLE9BQUEsRUFBUztnQkFBRSxZQUFBLEVBQWMsS0FBSyxDQUFDLE9BQVEsQ0FBQSxTQUFBLENBQTlCO2VBRFQ7O1lBRUYsS0FBQyxDQUFBLFNBQVMsQ0FBQyxJQUFYLENBQWdCLE9BQWhCLEVBQXlCLEtBQXpCO21CQUNBLE9BQUEsQ0FBQTtVQUxxQjtRQUFBLENBQUEsQ0FBQSxDQUFBLElBQUE7UUFNdkIsSUFBQyxDQUFBLFNBQVMsQ0FBQyxLQUFYLEdBQW1CO1FBQ25CLElBQUMsQ0FBQSxNQUFNLENBQUMsVUFBUixDQUFBLENBQ0UsQ0FBQyxPQUFELENBREYsQ0FDUyxJQURUO2VBRUE7TUFWb0MsQ0FBdEM7SUFYcUIsQ0FBdkI7RUFqTWlCLENBQW5CO0FBTkEiLCJmaWxlIjoiY2xpZW50L2NsaWVudC10ZXN0LmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiYXNzZXJ0ID0gcmVxdWlyZSBcImFzc2VydFwiXG5FdmVudEVtaXR0ZXIgPSByZXF1aXJlIFwiZXZlbnRzXCJcbkNsaWVudCA9IHJlcXVpcmUgXCIuL2NsaWVudFwiXG57bm9vcH0gPSByZXF1aXJlIFwibG9kYXNoXCJcbntyZXNvbHZlLCByZWplY3R9ID0gcmVxdWlyZSBcImJsdWViaXJkXCJcblxuZGVzY3JpYmUgXCJDbGllbnRcIiwgLT5cbiAgYmVmb3JlRWFjaCAtPlxuICAgIEB0cmFuc3BvcnQgPSBuZXcgRXZlbnRFbWl0dGVyKClcbiAgICBAY2xpZW50ID0gbmV3IENsaWVudChAdHJhbnNwb3J0KVxuXG4gIGRlc2NyaWJlIFwic2VuZCBmcmFtZVwiLCAtPlxuICAgIGl0IFwic2hvdWxkIHNlbmQgdG8gdHJhbnNwb3J0XCIsIC0+XG4gICAgICBAdHJhbnNwb3J0LnNlbmRGcmFtZSA9IChmcmFtZSkgLT5cbiAgICAgICAgYXNzZXJ0IGZyYW1lXG4gICAgICAgIHJlc29sdmUoKVxuICAgICAgQGNsaWVudC5zZW5kRnJhbWUge31cbiAgICBcbiAgICBpdCBcInNob3VsZCBub3Qgc2VuZCB3aGVuIGRpc2Nvbm5lY3RlZFwiLCAtPlxuICAgICAgQGNsaWVudC5kaXNjb25uZWN0ZWQgPSB0cnVlXG4gICAgICBAY2xpZW50LnNlbmRGcmFtZSgpXG4gICAgICAgIC5jYXRjaCAoZXJyKSAtPlxuICAgICAgICAgIC9kaXNjb25uZWN0ZWQvLnRlc3QgZXJyLm1lc3NhZ2VcblxuICBkZXNjcmliZSBcImF1dG8gaGVhcnRiZWF0XCIsIC0+XG4gICAgaXQgXCJzaG91bGQgbm90IHNlbmQgaWYgemVyb1wiLCAtPlxuICAgICAgQHRyYW5zcG9ydC5hdXRvSGVhcnRiZWF0ID0gLT5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaW52YWxpZCBjb2RlIHBhdGhcIilcbiAgICAgIEBjbGllbnQuYXV0b0hlYXJ0YmVhdCBcIjUwMDAsMFwiXG5cbiAgICBpdCBcInNob3VsZCBzZW5kIGhlYXJ0YmVhdCBtYXhcIiwgLT5cbiAgICAgIEB0cmFuc3BvcnQuYXV0b0hlYXJ0YmVhdCA9IChtcykgLT5cbiAgICAgICAgYXNzZXJ0LmVxdWFsIG1zLCA2MDAwMFxuICAgICAgQGNsaWVudC5hdXRvSGVhcnRiZWF0IFwiNTAwMCw2MDAwMFwiXG5cbiAgZGVzY3JpYmUgXCJzZW5kIGZyYW1lIHdpdGggcmVjZWlwdFwiLCAtPlxuICAgIGl0IFwic2hvdWxkIGdlbmVyYXRlIHVuaXF1ZSBpZFwiLCAtPlxuICAgICAgcmVjZWlwdHMgPSBbXVxuICAgICAgQHRyYW5zcG9ydC5zZW5kRnJhbWUgPSAoZnJhbWUpID0+XG4gICAgICAgIHJlY2VpcHRzLnB1c2ggZnJhbWUuaGVhZGVyc1tcInJlY2VpcHRcIl1cbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICBcbiAgICAgIEBjbGllbnQuc2VuZEZyYW1lV2l0aFJlY2VpcHQoaGVhZGVyczoge30pXG4gICAgICBAY2xpZW50LnNlbmRGcmFtZVdpdGhSZWNlaXB0KGhlYWRlcnM6IHt9KVxuICAgICAgXG4gICAgICBhc3NlcnQubm90RXF1YWwgcmVjZWlwdHNbMF0sIHJlY2VpcHRzWzFdXG5cbiAgICBpdCBcInNob3VsZCByZXNvbHZlIHdoZW4gcmVjZWl2ZWRcIiwgLT5cbiAgICAgIEB0cmFuc3BvcnQuc2VuZEZyYW1lID0gKGZyYW1lKSA9PlxuICAgICAgICBzZXRJbW1lZGlhdGUgPT5cbiAgICAgICAgICByZWNlaXB0ID0gXG4gICAgICAgICAgICBjb21tYW5kOiBcIlJFQ0VJUFRcIlxuICAgICAgICAgICAgaGVhZGVyczogeyBcInJlY2VpcHQtaWRcIjogZnJhbWUuaGVhZGVyc1tcInJlY2VpcHRcIl0gfVxuICAgICAgICAgIEB0cmFuc3BvcnQuZW1pdCBcImZyYW1lXCIsIHJlY2VpcHRcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICBAY2xpZW50LnNlbmRGcmFtZVdpdGhSZWNlaXB0KGhlYWRlcnM6IHt9KVxuXG4gICAgaXQgXCJzaG91bGQgZmFpbCBvbiBzZXJ2ZXIgZXJyb3JcIiwgLT5cbiAgICAgIEB0cmFuc3BvcnQuc2VuZEZyYW1lID0gKGZyYW1lKSA9PlxuICAgICAgICBzZXRJbW1lZGlhdGUgPT5cbiAgICAgICAgICBlcnJvciA9IFxuICAgICAgICAgICAgY29tbWFuZDogXCJFUlJPUlwiXG4gICAgICAgICAgICBoZWFkZXJzOiB7IFwicmVjZWlwdC1pZFwiOiBmcmFtZS5oZWFkZXJzW1wicmVjZWlwdFwiXSB9XG4gICAgICAgICAgQHRyYW5zcG9ydC5lbWl0IFwiZnJhbWVcIiwgZXJyb3JcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICBvblN1Y2Nlc3MgPSAtPlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkIGNvZGUgcGF0aFwiKVxuICAgICAgQGNsaWVudC5zZW5kRnJhbWVXaXRoUmVjZWlwdChoZWFkZXJzOiB7fSlcbiAgICAgICAgLnRoZW4gb25TdWNjZXNzLCBub29wXG5cbiAgZGVzY3JpYmUgXCJjb25uZWN0XCIsIC0+XG4gICAgaXQgXCJzaG91bGQgcmVxdWlyZSBoZWFkZXJzXCIsIC0+XG4gICAgICBhc3NlcnQudGhyb3dzICg9PiBAY2xpZW50LmNvbm5lY3QoKSksIC9oZWFkZXJzL1xuICAgIFxuICAgIGl0IFwic2hvdWxkIHJlcXVpcmUgYWNjZXB0IHZlcnNpb25cIiwgLT5cbiAgICAgIGFzc2VydC50aHJvd3MgKD0+IEBjbGllbnQuY29ubmVjdCh7fSkpLCAvYWNjZXB0LXZlcnNpb24vXG4gICAgXG4gICAgaXQgXCJzaG91bGQgcmVxdWlyZSBob3N0XCIsIC0+XG4gICAgICBoZWFkZXJzID0geyBcImFjY2VwdC12ZXJzaW9uXCI6IFwiMS4yXCIgfVxuICAgICAgYXNzZXJ0LnRocm93cyAoPT4gQGNsaWVudC5jb25uZWN0IGhlYWRlcnMpLCAvaG9zdC9cbiAgXG4gICAgaXQgXCJzaG91bGQgc2VuZCBjb25uZWN0IGNvbW1hbmRcIiwgLT5cbiAgICAgIEB0cmFuc3BvcnQuc2VuZEZyYW1lID0gKGZyYW1lKSAtPlxuICAgICAgICBhc3NlcnQuZXF1YWwgZnJhbWUuY29tbWFuZCwgXCJDT05ORUNUXCJcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICBAY2xpZW50LmNvbm5lY3QoXCJhY2NlcHQtdmVyc2lvblwiOiBcIjEuMlwiLCBob3N0OiBcImxvY2FsaG9zdFwiKVxuICAgICAgbnVsbFxuICAgIFxuICAgIGl0IFwic2hvdWxkIGFkZCBkZWZhdWx0IGhlYXJ0LWJlYXRcIiwgLT5cbiAgICAgIEB0cmFuc3BvcnQuc2VuZEZyYW1lID0gKGZyYW1lKSAtPlxuICAgICAgICBhc3NlcnQuZXF1YWwgZnJhbWUuaGVhZGVyc1tcImhlYXJ0LWJlYXRcIl0sIFwiMTAwMDAsMFwiXG4gICAgICAgIHJlc29sdmUoKVxuICAgICAgQGNsaWVudC5jb25uZWN0KFwiYWNjZXB0LXZlcnNpb25cIjogXCIxLjJcIiwgaG9zdDogXCJsb2NhbGhvc3RcIilcbiAgICAgIG51bGxcbiAgICBcbiAgICBpdCBcInNob3VsZCByZXNvbHZlIHdoZW4gY29ubmVjdGVkXCIsIC0+XG4gICAgICBAdHJhbnNwb3J0LnNlbmRGcmFtZSA9ID0+XG4gICAgICAgIHNldEltbWVkaWF0ZSA9PlxuICAgICAgICAgIGNvbm5lY3RlZCA9IFxuICAgICAgICAgICAgY29tbWFuZDogXCJDT05ORUNURURcIlxuICAgICAgICAgICAgaGVhZGVyczoge31cbiAgICAgICAgICBAdHJhbnNwb3J0LmVtaXQgXCJmcmFtZVwiLCBjb25uZWN0ZWRcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICBAY2xpZW50LmNvbm5lY3QoXCJhY2NlcHQtdmVyc2lvblwiOiBcIjEuMlwiLCBob3N0OiBcImxvY2FsaG9zdFwiKVxuXG4gIGRlc2NyaWJlIFwic2VuZFwiLCAtPlxuICAgIGl0IFwic2hvdWxkIHJlcXVpcmUgaGVhZGVyc1wiLCAtPiAgICAgIFxuICAgICAgYXNzZXJ0LnRocm93cyAoPT4gQGNsaWVudC5zZW5kKCkpLCAvaGVhZGVycy9cbiAgICBcbiAgICBpdCBcInNob3VsZCByZXF1aXJlIGRlc3RpbmF0aW9uXCIsIC0+XG4gICAgICBhc3NlcnQudGhyb3dzICg9PiBAY2xpZW50LnNlbmQge30pLCAvZGVzdGluYXRpb24vXG4gICAgXG4gICAgaXQgXCJzaG91bGQgbWFwIHRvIHNlbmQgY29tbWFuZFwiLCAtPlxuICAgICAgQHRyYW5zcG9ydC5zZW5kRnJhbWUgPSAoZnJhbWUpIC0+XG4gICAgICAgIGFzc2VydC5lcXVhbCBmcmFtZS5jb21tYW5kLCBcIlNFTkRcIlxuICAgICAgICByZXNvbHZlKClcbiAgICAgIEBjbGllbnQuc2VuZChkZXN0aW5hdGlvbjogXCIvb3R0YXdhXCIpXG4gICAgICBudWxsXG4gIFxuICBkZXNjcmliZSBcInN1YnNjcmliZVwiLCAtPlxuICAgIGl0IFwic2hvdWxkIHJlcXVpcmUgaGVhZGVyc1wiLCAtPlxuICAgICAgYXNzZXJ0LnRocm93cyAoPT4gQGNsaWVudC5zdWJzY3JpYmUoKSksIC9oZWFkZXJzL1xuICAgIFxuICAgIGl0IFwic2hvdWxkIHJlcXVpcmUgZGVzdGluYXRpb25cIiwgLT5cbiAgICAgIGFzc2VydC50aHJvd3MgKD0+IEBjbGllbnQuc3Vic2NyaWJlKHt9KSksIC9kZXN0aW5hdGlvbi9cbiAgICBcbiAgICBpdCBcInNob3VsZCBtYXAgdG8gc3Vic2NyaWJlIGNvbW1hbmRcIiwgLT5cbiAgICAgIEB0cmFuc3BvcnQuc2VuZEZyYW1lID0gKGZyYW1lKSAtPlxuICAgICAgICBhc3NlcnQuZXF1YWwgZnJhbWUuY29tbWFuZCwgXCJTVUJTQ1JJQkVcIlxuICAgICAgICByZXNvbHZlKClcbiAgICAgIEBjbGllbnQuc3Vic2NyaWJlKHsgaWQ6IFwiMVwiLCBkZXN0aW5hdGlvbjogXCIvdG9yb250b1wiIH0pXG4gICAgICBudWxsXG4gICAgXG4gICAgaXQgXCJzaG91bGQgZ2VuZXJhdGUgdW5pcXVlIGlkc1wiLCAtPlxuICAgICAgaWRzID0gW11cbiAgICAgIEB0cmFuc3BvcnQuc2VuZEZyYW1lID0gKGZyYW1lKSAtPlxuICAgICAgICBpZHMucHVzaCBmcmFtZS5oZWFkZXJzLmlkXG4gICAgICAgIHJlc29sdmUoKVxuICAgICAgQGNsaWVudC5zdWJzY3JpYmUoeyBkZXN0aW5hdGlvbjogXCIvcGVydVwiIH0pXG4gICAgICBAY2xpZW50LnN1YnNjcmliZSh7IGRlc3RpbmF0aW9uOiBcIi9pY2VsYW5kXCIgfSlcbiAgICAgIGFzc2VydC5ub3RFcXVhbCBpZHNbMF0sIGlkc1sxXVxuICBcbiAgZGVzY3JpYmUgXCJ1bnN1YnNjcmliZVwiLCAtPlxuICAgIGl0IFwic2hvdWxkIHJlcXVpcmUgaGVhZGVyc1wiLCAtPlxuICAgICAgYXNzZXJ0LnRocm93cyAoPT4gQGNsaWVudC51bnN1YnNjcmliZSgpKSwgL2hlYWRlcnMvXG4gICAgXG4gICAgaXQgXCJzaG91bGQgcmVxdWlyZSBpZFwiLCAtPlxuICAgICAgYXNzZXJ0LnRocm93cyAoPT4gQGNsaWVudC51bnN1YnNjcmliZSB7fSksIC9pZC9cbiAgICBcbiAgICBpdCBcInNob3VsZCBtYXAgdG8gdW5zdWJzY3JpYmUgY29tbWFuZFwiLCAtPlxuICAgICAgQHRyYW5zcG9ydC5zZW5kRnJhbWUgPSAoZnJhbWUpIC0+XG4gICAgICAgIGFzc2VydC5lcXVhbCBmcmFtZS5jb21tYW5kLCBcIlVOU1VCU0NSSUJFXCJcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICBAY2xpZW50LnVuc3Vic2NyaWJlKGlkOiBcInN1Yi0xXCIpXG4gICAgICBudWxsXG5cbiAgZGVzY3JpYmUgXCJzb3VyY2VcIiwgLT5cbiAgICBpdCBcInNob3VsZCBzdWJzY3JpYmUgYW5kIHVuc3Vic2NyaWJlXCIsIChkb25lKSAtPlxuICAgICAgY29tbWFuZHMgPSBbXVxuICAgICAgQHRyYW5zcG9ydC5zZW5kRnJhbWUgPSAoZnJhbWUpID0+XG4gICAgICAgIGNvbW1hbmRzLnB1c2ggZnJhbWUuY29tbWFuZFxuICAgICAgICByZWNlaXB0ID0gXG4gICAgICAgICAgY29tbWFuZDogXCJSRUNFSVBUXCJcbiAgICAgICAgICBoZWFkZXJzOiB7IFwicmVjZWlwdC1pZFwiOiBmcmFtZS5oZWFkZXJzW1wicmVjZWlwdFwiXSB9XG4gICAgICAgIEB0cmFuc3BvcnQuZW1pdCBcImZyYW1lXCIsIHJlY2VpcHRcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICBzb3VyY2UgPSBAY2xpZW50LnNvdXJjZShkZXN0aW5hdGlvbjogXCIvcGFyaXNcIilcbiAgICAgIFxuICAgICAgY29tcGxldGUgPSAtPlxuICAgICAgICBhc3NlcnQuZXF1YWwgY29tbWFuZHNbMF0sIFwiU1VCU0NSSUJFXCJcbiAgICAgICAgYXNzZXJ0LmVxdWFsIGNvbW1hbmRzWzFdLCBcIlVOU1VCU0NSSUJFXCJcbiAgICAgICAgZG9uZSgpXG4gICAgICBcbiAgICAgIHN1YiA9IHNvdXJjZS5zdWJzY3JpYmUobmV4dDogbm9vcCwgZXJyb3I6IG5vb3AsIGNvbXBsZXRlOiBjb21wbGV0ZSlcbiAgICAgIHNldFRpbWVvdXQgKC0+IHN1Yi51bnN1YnNjcmliZSgpKSwgNVxuICAgICAgc2V0VGltZW91dCBjb21wbGV0ZSwgNVxuICAgIFxuICAgIGl0IFwic2hvdWxkIHB1c2ggZnJhbWUgYm9keSBtZXNzYWdlXCIsIChkb25lKSAtPlxuICAgICAgQHRyYW5zcG9ydC5zZW5kRnJhbWUgPSAoZnJhbWUpID0+XG4gICAgICAgIHJlY2VpcHQgPSBcbiAgICAgICAgICBjb21tYW5kOiBcIlJFQ0VJUFRcIlxuICAgICAgICAgIGhlYWRlcnM6IHsgXCJyZWNlaXB0LWlkXCI6IGZyYW1lLmhlYWRlcnNbXCJyZWNlaXB0XCJdIH1cbiAgICAgICAgQHRyYW5zcG9ydC5lbWl0IFwiZnJhbWVcIiwgcmVjZWlwdFxuICAgICAgICByZXNvbHZlKClcbiAgICAgIHNvdXJjZSA9IEBjbGllbnQuc291cmNlKGRlc3RpbmF0aW9uOiBcIi9tb3Njb3dcIiwgaWQ6IFwiUzFcIilcbiAgICAgIHN1YiA9IHNvdXJjZS5zdWJzY3JpYmVcbiAgICAgICAgbmV4dDogKG1lc3NhZ2UpIC0+XG4gICAgICAgICAgYXNzZXJ0LmVxdWFsIG1lc3NhZ2UsIFwib2tcIlxuICAgICAgICAgIHN1Yi51bnN1YnNjcmliZSgpXG4gICAgICAgICAgZG9uZSgpXG4gICAgICBvbk1lc3NhZ2UgPSA9PlxuICAgICAgICBtZXNzYWdlID0gXG4gICAgICAgICAgY29tbWFuZDogXCJNRVNTQUdFXCJcbiAgICAgICAgICBoZWFkZXJzOlxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiBcIlMxXCJcbiAgICAgICAgICBib2R5OiBcIm9rXCJcbiAgICAgICAgQHRyYW5zcG9ydC5lbWl0IFwiZnJhbWVcIiwgbWVzc2FnZVxuICAgICAgc2V0VGltZW91dCBvbk1lc3NhZ2UsIDVcbiAgXG4gIGRlc2NyaWJlIFwiZGlzY29ubmVjdFwiLCAtPlxuICAgIGl0IFwic2hvdWxkIGNsb3NlIHRyYW5zcG9ydCBvbiByZWNlaXB0XCIsIChkb25lKSAtPlxuICAgICAgQHRyYW5zcG9ydC5zZW5kRnJhbWUgPSAoZnJhbWUpID0+XG4gICAgICAgIHJlY2VpcHQgPSBcbiAgICAgICAgICBjb21tYW5kOiBcIlJFQ0VJUFRcIlxuICAgICAgICAgIGhlYWRlcnM6IHsgXCJyZWNlaXB0LWlkXCI6IGZyYW1lLmhlYWRlcnNbXCJyZWNlaXB0XCJdIH1cbiAgICAgICAgQHRyYW5zcG9ydC5lbWl0IFwiZnJhbWVcIiwgcmVjZWlwdFxuICAgICAgICByZXNvbHZlKClcbiAgICAgIEB0cmFuc3BvcnQuY2xvc2UgPSBkb25lXG4gICAgICBAY2xpZW50LmRpc2Nvbm5lY3QoKVxuICAgIFxuICAgIGl0IFwic2hvdWxkIGNsb3NlIHRyYW5zcG9ydCBvbiBlcnJvclwiLCAoZG9uZSkgLT5cbiAgICAgIEB0cmFuc3BvcnQuc2VuZEZyYW1lID0gKGZyYW1lKSA9PlxuICAgICAgICBlcnJvciA9IFxuICAgICAgICAgIGNvbW1hbmQ6IFwiRVJST1JcIlxuICAgICAgICAgIGhlYWRlcnM6IHsgXCJyZWNlaXB0LWlkXCI6IGZyYW1lLmhlYWRlcnNbXCJyZWNlaXB0XCJdIH1cbiAgICAgICAgQHRyYW5zcG9ydC5lbWl0IFwiZnJhbWVcIiwgZXJyb3JcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICBAdHJhbnNwb3J0LmNsb3NlID0gZG9uZVxuICAgICAgQGNsaWVudC5kaXNjb25uZWN0KClcbiAgICAgICAgLmNhdGNoIG5vb3BcbiAgICAgIG51bGxcbiJdfQ==
